# Запуск API с поддержкой TLS (SSL)

В этом документе описано, как запустить REST, GraphQL и gRPC API с поддержкой TLS.

## Предварительные требования

- Docker и Docker Compose
- OpenSSL (для генерации сертификатов)

## Шаги для запуска SSL-версии

### 1. Генерация сертификатов

Перед запуском сервисов необходимо сгенерировать SSL-сертификаты.

```bash
# Сделайте скрипт исполняемым
chmod +x ./generate-certs.sh

# Запустите скрипт для генерации сертификатов
./generate-certs.sh
```

Скрипт создаст необходимые сертификаты в директории `./certs`.

### 2. Запуск сервисов с TLS

```bash
# Запуск всех сервисов с TLS
docker-compose -f docker-compose.ssl.yml up -d

# Запуск конкретного сервиса
docker-compose -f docker-compose.ssl.yml up -d rest-api-ssl
```

## Доступ к API через TLS

### REST API

REST API доступен по HTTPS на порту 8443:

```bash
curl -k https://localhost:8443/
curl -k https://localhost:8443/users
```

Параметр `-k` используется для пропуска проверки сертификата (в случае самоподписанных сертификатов).

Если вы хотите использовать сертификат, добавьте CA сертификат в параметры:

```bash
curl --cacert ./certs/ca.crt https://localhost:8443/
```

### GraphQL API

GraphQL API доступен по HTTPS на порту 8444:

```bash
curl -k https://localhost:8444/graphql
```

Для выполнения GraphQL запросов можно использовать GraphQL Playground, доступный по адресу:
https://localhost:8444/graphql

### gRPC API

gRPC API с SSL доступен на порту 50052. Для отправки запросов к gRPC API с SSL можно использовать grpcurl с параметрами для TLS:

```bash
grpcurl -insecure localhost:50052 list
```

Или использовать CA сертификат:

```bash
grpcurl -cacert ./certs/ca.crt localhost:50052 list
```

## Примечания по безопасности

- В данной конфигурации используются самоподписанные сертификаты, которые подходят для разработки и тестирования.
- Для продакшн-окружения следует использовать сертификаты, выданные доверенным центром сертификации.
- Клиентская аутентификация (mTLS) не включена по умолчанию, но может быть добавлена при необходимости.
